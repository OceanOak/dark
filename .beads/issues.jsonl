{"id":"app-18u","title":"Design: Update Propagation Scoping Rules","description":"Defines boundaries for automatic vs manual updates based on ownership and branches.\n\n## Key Design Decisions\n\n1. **Same branch, same owner**:\n   - Auto-propagate type-compatible changes? (recommended: yes)\n   - Show todo list for incompatible changes? (recommended: yes)\n\n2. **Different branch, same owner**:\n   - Auto-propagate? (probably no - branches are isolation)\n   - Show 'update available' indicator? (maybe)\n   - User explicitly pulls updates?\n\n3. **Different owner** (e.g., you depend on Stdlib):\n   - Never auto-propagate (you don't own their code)\n   - Show 'newer version available' when they open file?\n   - Explicit 'upgrade dependencies' action?\n\n4. **The 'published' concept**:\n   - Should there be a distinction between 'draft' and 'published' code?\n   - Published = stable contract, draft = can change freely?\n   - Affects whether dependents get notified?\n\n5. **Matrix**:\n```\n                    | Same Branch | Diff Branch | Diff Owner\n--------------------|-------------|-------------|------------\nType Compatible     | Auto        | Notify      | Notify\nType Incompatible   | Todo List   | Notify      | Notify\n```\n\n6. **Implementation**:\n```dark\nlet shouldAutoPropagate \n  (updaterAccount: Uuid) (updaterBranch: BranchID)\n  (dependentAccount: Uuid) (dependentBranch: BranchID)\n  : PropagationMode =\n  if updaterAccount \\!= dependentAccount then\n    PropagationMode.NotifyOnly\n  else if updaterBranch \\!= dependentBranch then\n    PropagationMode.NotifyOnly\n  else\n    PropagationMode.AutoIfCompatible\n```","status":"open","priority":1,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T14:45:12.955774043Z","created_by":"OceanOak","updated_at":"2026-01-12T14:45:12.955774043Z","dependencies":[{"issue_id":"app-18u","depends_on_id":"app-7rl","type":"parent-child","created_at":"2026-01-12T14:47:52.927493506Z","created_by":"OceanOak"}]}
{"id":"app-1p0","title":"VSCode: Remove hardcoded host/port in http.ts","description":"http.ts has hardcoded DARK_EDITOR_HOST and DARK_EDITOR_PORT with CLEANUP TODO. Make configurable or remove if unused.","status":"open","priority":3,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T12:01:24.683917842Z","created_by":"OceanOak","updated_at":"2026-01-12T12:01:24.683917842Z"}
{"id":"app-26n","title":"VSCode: Unsandboxed external iframe in homepage","description":"homepagePanel.ts line 338 embeds iframe to wip.darklang.com with no sandbox attribute. Fix: add sandbox='allow-scripts allow-same-origin' for isolation.","status":"open","priority":2,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:56:30.504834511Z","created_by":"OceanOak","updated_at":"2026-01-12T11:56:30.504834511Z"}
{"id":"app-365","title":"VSCode: Use OutputChannel instead of console.log","description":"Extension uses console.log/error throughout which users can't easily see. Create OutputChannel('Darklang') and use appendLine() for user-visible logging.","status":"open","priority":3,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T12:00:29.702278844Z","created_by":"OceanOak","updated_at":"2026-01-12T12:00:29.702278844Z"}
{"id":"app-5xm","title":"VSCode: Sync service spawn errors silently ignored","description":"extension.ts startSyncService/stopSyncService spawn processes with no error handler. Failures are invisible to users. Fix: add child.on('error') handler and show error message.","status":"open","priority":2,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:54:53.158534841Z","created_by":"OceanOak","updated_at":"2026-01-12T11:54:53.158534841Z"}
{"id":"app-6vc","title":"VSCode: Centralize account-to-LSP synchronization","description":"Account sync to LSP is scattered across extension.ts, homepagePanel.ts, approvalCommands.ts. Centralize: AccountService is source of truth, one sync layer pushes to LSP.","status":"open","priority":2,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T12:00:51.910243965Z","created_by":"OceanOak","updated_at":"2026-01-12T12:00:51.910243965Z"}
{"id":"app-7rl","title":"Epic: Code Update Propagation System","description":"Implement a system for updating existing code with automatic propagation to dependents.\n\n## Goals\n\n1. **Enable editing existing code** - not just creating new definitions\n2. **Track dependencies** - know who calls what\n3. **Auto-propagate compatible changes** - within same branch/owner\n4. **Show staleness** - visual indicator when using old version\n5. **Update panel** - list of things that need updating\n6. **Scoped updates** - don't auto-update other people's code\n\n## Key Principles\n\n- Everything content-addressed by UUID (already have this)\n- Names are metadata pointing to UUIDs (already have this via SetFnName)\n- Old versions never disappear (already have this - immutable)\n- Auto-propagate type-compatible changes on same branch\n- Todo list for breaking changes\n- Other owners' code stays pinned until they explicitly update\n\n## Child Issues\n\n- app-pf0: Enable updating existing code (foundational fix)\n- app-s4j: Dependency Index design\n- app-cnx: Type Compatibility Checking design\n- app-dns: Update Propagation Logic design\n- app-18u: Scoping Rules design\n- app-k0o: Staleness UI design\n\n## Implementation Order\n\n1. app-pf0 (enable updates) - can ship independently, gives lazy re-resolution\n2. app-s4j (dependency index) - foundation for everything else\n3. app-cnx (type compatibility) - needed for auto vs manual decision\n4. app-18u (scoping) - defines the rules\n5. app-dns (propagation logic) - the core algorithm\n6. app-k0o (UI) - user-facing features","status":"open","priority":1,"issue_type":"epic","owner":"oakocean9@gmail.com","created_at":"2026-01-12T14:46:57.463167174Z","created_by":"OceanOak","updated_at":"2026-01-12T14:58:08.87654693Z"}
{"id":"app-830","title":"VSCode: LSP client never restarts on crash","description":"In extension.ts line 92, maxRestartCount: 0 prevents LSP restart on crash. Users must reload window manually. Fix: set maxRestartCount: 5 or remove the option to use defaults.","status":"open","priority":1,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:50:06.21723143Z","created_by":"OceanOak","updated_at":"2026-01-12T11:50:06.21723143Z"}
{"id":"app-97y","title":"VSCode: Broken markdown branch switch command link","description":"In darkContentProvider.ts line 114, branch switch link passes plain string branchID but the command expects {id, name} object. Fix: encode JSON args properly.","status":"open","priority":2,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:52:33.611238846Z","created_by":"OceanOak","updated_at":"2026-01-12T11:52:33.611238846Z"}
{"id":"app-btk","title":"VSCode: Unused contentCache in darkFileSystemProvider","description":"contentCache Map is written to but never read from. Either implement actual caching/change detection or remove it to reduce complexity.","status":"open","priority":3,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:59:56.904254551Z","created_by":"OceanOak","updated_at":"2026-01-12T11:59:56.904254551Z"}
{"id":"app-cks","title":"VSCode: Unhandled webview message commands","description":"homepagePanel.ts webview posts createNew, openDocs, search commands but handler only supports navigate, unpin, openPackage, openProject, selectAccount. UI buttons silently do nothing.","status":"open","priority":2,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:54:28.33965301Z","created_by":"OceanOak","updated_at":"2026-01-12T11:54:28.33965301Z"}
{"id":"app-cnx","title":"Design: Type Compatibility Checking for auto-propagation","description":"Determines whether a function update can be automatically propagated to dependents, or requires manual intervention.\n\n## Key Design Decisions\n\n1. **What constitutes 'compatible'?**\n   - Same parameter types + return type? (strict)\n   - Contravariant params, covariant return? (Liskov)\n   - Same arity + compatible types? (looser)\n\n2. **Type parameter handling**:\n   - `foo\u003cT\u003e(x: T) -\u003e T` updated to `foo\u003cT\u003e(x: T) -\u003e T` - compatible\n   - `foo\u003cT\u003e(x: T) -\u003e T` updated to `foo\u003cT, U\u003e(x: T) -\u003e U` - incompatible?\n\n3. **What about semantic changes?**\n   - Type-compatible but behavior changed - should we still auto-propagate?\n   - Option: always auto-propagate type-compatible, trust the author\n   - Option: show diff, let user confirm\n\n4. **Implementation location**:\n   - New module: `LanguageTools.TypeCompatibility`\n   - Function: `isCompatible(oldDef, newDef) -\u003e CompatibilityResult`\n\n5. **Result type**:\n```dark\ntype CompatibilityResult =\n  | FullyCompatible\n  | CompatibleWithWarning of String  // e.g., 'return type widened'\n  | Incompatible of IncompatibilityReason\n\ntype IncompatibilityReason =\n  | ParamCountChanged\n  | ParamTypeChanged of Int64 * oldType: TypeRef * newType: TypeRef\n  | ReturnTypeChanged of oldType: TypeRef * newType: TypeRef\n  | TypeParamsChanged\n```","status":"open","priority":1,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T14:43:59.18034805Z","created_by":"OceanOak","updated_at":"2026-01-12T14:43:59.18034805Z","dependencies":[{"issue_id":"app-cnx","depends_on_id":"app-7rl","type":"parent-child","created_at":"2026-01-12T14:47:42.542526584Z","created_by":"OceanOak"}]}
{"id":"app-dep1","title":"Dependency Index: F# Implementation in PackageOpPlayback","description":"Implement dependency tracking in F# by hooking into PackageOpPlayback.fs.\n\n## Overview\nTrack what functions/types/values reference what other functions/types/values. This enables \"what calls this?\" and \"what does this call?\" queries.\n\n## Implementation Steps\n\n### 1. Create Migration\nAdd new `references` table:\n```sql\nCREATE TABLE references (\n  source_id TEXT NOT NULL,    -- the fn/value containing the reference\n  target_id TEXT NOT NULL,    -- the fn/type/value being referenced\n  ref_type TEXT NOT NULL,     -- 'fn', 'type', 'value'\n  PRIMARY KEY (source_id, target_id, ref_type)\n);\nCREATE INDEX idx_references_target ON references(target_id);\n```\n\n### 2. AST Walker (F#)\nCreate function to extract all referenced UUIDs from an expression:\n- `EFnName(_, Ok(Package uuid))` → function reference\n- `EPipeFnCall(_, Ok(Package uuid), ...)` → function reference\n- `EValue(_, Ok(Package uuid))` → value reference\n- `TCustomType(Ok(Package uuid), ...)` → type reference\n- Recursively walk entire expression tree\n\nLocation: New file `backend/src/LibPackageManager/DependencyExtractor.fs` or inline in PackageOpPlayback.fs\n\n### 3. Hook into PackageOpPlayback\nModify these functions to also store dependencies:\n- `applyAddFn` (line 61-77) - walk fn.body\n- `applyAddValue` (line 41-58) - walk value.body\n- `applyAddType` (line 22-38) - walk type definition for type refs\n\n### 4. Query Functions\nAdd to PackageManager or Queries.fs:\n- `getDependents(uuid) -\u003e List\u003cuuid\u003e` - what references this?\n- `getDependencies(uuid) -\u003e List\u003cuuid\u003e` - what does this reference?\n\n## Files to Modify\n- `backend/src/LibPackageManager/PackageOpPlayback.fs`\n- `backend/src/LibPackageManager/Queries.fs`\n- New migration file\n\n## Parent Epic\napp-7rl (Code Update Propagation System)\n\n## Relationship to app-s4j\nThis is the implementation of the design in app-s4j, using the F# approach.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-13T18:00:47Z","updated_at":"2026-01-13T18:00:47Z","dependencies":[{"issue_id":"app-dep1","depends_on_id":"app-7rl","type":"parent-child","created_at":"2026-01-13T18:01:19Z","created_by":"claude","metadata":"{}"}]}
{"id":"app-dep2","title":"Dependency Index: Darklang Package Implementation","description":"Implement dependency tracking in Darklang by creating a package that extracts and stores references.\n\n## Overview\nTrack what functions/types/values reference what other functions/types/values. This enables \"what calls this?\" and \"what does this call?\" queries. Dogfooding approach - write the logic in Darklang itself.\n\n## Implementation Steps\n\n### 1. Create Migration (still needed in F#)\nAdd new `references` table - same schema as F# approach.\n\n### 2. AST Walker (Darklang)\nCreate module `Darklang.LanguageTools.DependencyExtractor`:\n\n```dark\nmodule Darklang.LanguageTools.DependencyExtractor\n\ntype Reference = \n  { sourceId: Uuid\n    targetId: Uuid\n    refType: String }  // \"fn\", \"type\", \"value\"\n\n/// Extract all references from an expression\nlet extractFromExpr (expr: ProgramTypes.Expr): List\u003cUuid * String\u003e =\n  match expr with\n  | EFnName(_, Ok(Package uuid)) -\u003e [(uuid, \"fn\")]\n  | EValue(_, Ok(Package uuid)) -\u003e [(uuid, \"value\")]\n  // ... recursively walk all variants\n  | _ -\u003e []\n\n/// Extract all references from a function\nlet extractFromFn (fn: PackageFn.PackageFn): List\u003cReference\u003e =\n  let bodyRefs = extractFromExpr fn.body\n  let paramTypeRefs = fn.parameters |\u003e List.flatMap (fun p -\u003e extractFromTypeRef p.typ)\n  let returnTypeRefs = extractFromTypeRef fn.returnType\n  // Combine and dedupe\n  ...\n```\n\n### 3. Hook Point\nNeed F# to call this Darklang code when processing AddFn/AddValue ops.\nOptions:\n- Expose as builtin that F# calls\n- Run as post-processing step\n- Trigger via package op handler\n\n### 4. Query Functions (Darklang)\n```dark\nmodule Darklang.LanguageTools.Dependencies\n\n/// Get all items that reference the given UUID\nlet getDependents (targetId: Uuid): List\u003cUuid\u003e =\n  // SQL query against references table\n  ...\n\n/// Get all UUIDs that the given item references  \nlet getDependencies (sourceId: Uuid): List\u003cUuid\u003e =\n  // SQL query against references table\n  ...\n```\n\n## Files to Create/Modify\n- `packages/darklang/languageTools/dependencyExtractor.dark` (new)\n- `packages/darklang/languageTools/dependencies.dark` (new)\n- Backend hook to call the Darklang code\n\n## Pros\n- Dogfooding - uses Darklang to build Darklang\n- Easier to iterate on the logic\n- More visible/editable\n\n## Cons\n- Needs bridge from F# to call Darklang code\n- Slightly more complex setup\n\n## Parent Epic\napp-7rl (Code Update Propagation System)\n\n## Relationship to app-s4j\nThis is an alternative implementation of the design in app-s4j, using Darklang.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-13T18:01:03Z","updated_at":"2026-01-13T18:01:03Z","dependencies":[{"issue_id":"app-dep2","depends_on_id":"app-7rl","type":"parent-child","created_at":"2026-01-13T18:01:19Z","created_by":"claude","metadata":"{}"}]}
{"id":"app-dns","title":"Design: Update Propagation Logic","description":"The mechanism for cascading updates to dependents when a function/type/value is updated.\n\n## Key Design Decisions\n\n1. **Propagation trigger**:\n   - Synchronous during fileSystem/write? (simpler, but slower)\n   - Async job after write completes? (faster response, eventual consistency)\n   - User-initiated only? (most control, more manual)\n\n2. **Cascade depth**:\n   - Full transitive closure (A→B→C all updated)?\n   - Single level only (just direct dependents)?\n   - Configurable?\n\n3. **Handling cycles**:\n   - A calls B, B calls A - both updated, what happens?\n   - Need topological sort or cycle detection\n\n4. **Failure handling**:\n   - If propagating to dep X fails (e.g., type incompatible), what about Y?\n   - Continue with others? Roll back all? Mark X as 'needs attention'?\n\n5. **Algorithm sketch**:\n```dark\nlet propagateUpdate (branchID: BranchID) (oldId: Uuid) (newId: Uuid): PropagationResult =\n  let directDeps = getDependents branchID oldId\n  \n  let (autoUpdated, needsManual) = \n    directDeps |\u003e List.partition (fun depId -\u003e\n      let dep = pm.getFn depId\n      let source = prettyPrint dep\n      let reparsed = parse source  // re-resolves names\n      isTypeCompatible dep reparsed)\n  \n  // Recurse for auto-updated ones\n  let cascaded = autoUpdated |\u003e List.flatMap (fun updated -\u003e\n    propagateUpdate branchID updated.oldId updated.newId)\n  \n  { autoUpdated = autoUpdated ++ cascaded.autoUpdated\n    needsManual = needsManual ++ cascaded.needsManual }\n```\n\n6. **PackageOp integration**:\n   - New op type? `PropagateUpdate of oldId: Uuid * newId: Uuid`\n   - Or just generate AddFn + SetFnName for each propagated update?","status":"open","priority":1,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T14:44:42.349765751Z","created_by":"OceanOak","updated_at":"2026-01-12T14:44:42.349765751Z","dependencies":[{"issue_id":"app-dns","depends_on_id":"app-7rl","type":"parent-child","created_at":"2026-01-12T14:47:47.69794292Z","created_by":"OceanOak"},{"issue_id":"app-dns","depends_on_id":"app-s4j","type":"blocks","created_at":"2026-01-12T14:48:57.165561008Z","created_by":"OceanOak"},{"issue_id":"app-dns","depends_on_id":"app-cnx","type":"blocks","created_at":"2026-01-12T14:49:02.371917385Z","created_by":"OceanOak"},{"issue_id":"app-dns","depends_on_id":"app-18u","type":"blocks","created_at":"2026-01-12T14:49:07.571008096Z","created_by":"OceanOak"}]}
{"id":"app-k0o","title":"Design: Staleness UI and Update Panel","description":"UI/UX for showing outdated references and managing updates.\n\n## Key Design Decisions\n\n1. **Staleness indicator in editor**:\n   - Show shortened UUID suffix? e.g., `foo_a3f2` when current is `_b7c1`\n   - Underline/highlight stale calls?\n   - Hover tooltip with details?\n   - Diagnostic warning in Problems panel?\n\n2. **Update panel/view**:\n   - Dedicated sidebar panel? Tree view?\n   - Inline in file explorer?\n   - Command palette actions?\n\n3. **Update actions**:\n   - 'Update all on this branch' button\n   - 'Update selected' with checkboxes\n   - 'Update this file' \n   - 'Ignore this update' (pin to old version intentionally)\n\n4. **Information to show**:\n   - Which function is stale\n   - What changed (diff? changelog?)\n   - Is it type-compatible (safe) or breaking?\n   - How many dependents affected\n\n5. **LSP integration**:\n   - New diagnostic type for stale references\n   - Code actions: 'Update to latest version'\n   - Custom request: `darklang/getUpdateStatus`\n   - Custom request: `darklang/applyUpdates`\n\n6. **Mockup**:\n```\n┌─ Updates Available ─────────────────────┐\n│                                         │\n│ MyModule.helper (3 references)          │\n│   ├─ MyModule.main:12      [Update]     │\n│   ├─ MyModule.process:34   [Update]     │\n│   └─ MyModule.test:56      [Update]     │\n│                                         │\n│ Stdlib.List.map (1 reference)           │\n│   └─ MyModule.transform:8  [Update]     │\n│                                         │\n│ [Update All Compatible] [Dismiss]       │\n└─────────────────────────────────────────┘\n```","status":"open","priority":2,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T14:45:43.663980501Z","created_by":"OceanOak","updated_at":"2026-01-12T14:45:43.663980501Z","dependencies":[{"issue_id":"app-k0o","depends_on_id":"app-7rl","type":"parent-child","created_at":"2026-01-12T14:47:58.219885091Z","created_by":"OceanOak"},{"issue_id":"app-k0o","depends_on_id":"app-dns","type":"blocks","created_at":"2026-01-12T14:49:12.775241834Z","created_by":"OceanOak"}]}
{"id":"app-oth","title":"Improve VSCode extension performance","description":"Investigate and improve the performance of the VSCode extension. This may include optimizing startup time, reducing memory usage, and improving responsiveness.","status":"open","priority":2,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T08:43:43.589545887Z","created_by":"OceanOak","updated_at":"2026-01-12T08:44:11.752093636Z"}
{"id":"app-pf0","title":"Enable updating existing code (not just creating new)","description":"Currently fileSystem/write only creates NEW definitions - it skips if the name already exists.\n\n## The Fix\n\nIn `fileSystemProvider.dark`, the write handler checks:\n```dark\nmatch existingFnId with\n| Some _id -\u003e []   // ← Returns empty, does nothing\\!\n| None -\u003e // Creates AddFn + SetFnName\n```\n\nChange to always create new definition and repoint:\n```dark\n// Always create new immutable definition\nlet (packageFn, _) = toPackageFnPT ...\n[ AddFn packageFn\n  SetFnName (packageFn.id, fnLocation) ]  // Repoint name to new def\n```\n\n## Locations in code\n\n- `packages/darklang/languageTools/lsp-server/fileSystemProvider.dark`\n  - Lines 360-376 (types)\n  - Lines 398-414 (functions)  \n  - Lines 436-452 (values)\n\n## Prerequisite for\n\nThis is the foundational change that enables the update propagation system. Without this, we can't update existing code at all.\n\n## Note\n\nThis change alone gives us 'lazy re-resolution' - dependents get updated when they're re-saved. The propagation system (app-dns) adds automatic cascading.","status":"open","priority":1,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T14:46:26.603005924Z","created_by":"OceanOak","updated_at":"2026-01-12T14:46:26.603005924Z","dependencies":[{"issue_id":"app-pf0","depends_on_id":"app-7rl","type":"parent-child","created_at":"2026-01-12T14:47:32.133533677Z","created_by":"OceanOak"}]}
{"id":"app-pku","title":"VSCode: Misleading base64 comment in darkFileSystemProvider","description":"Line 125 comment says 'Content must be base64 encoded' but code uses UTF-8: Buffer.from(content).toString('utf-8'). Either fix the encoding or update the comment.","status":"open","priority":2,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:52:11.050220627Z","created_by":"OceanOak","updated_at":"2026-01-12T11:52:11.050220627Z"}
{"id":"app-rv9","title":"VSCode: Add .catch() to promise chains","description":"packagesTreeDataProvider.ts and other files have .then() without .catch(), causing unhandled promise rejections. Add error handlers to all promise chains.","status":"open","priority":3,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T12:01:08.329321875Z","created_by":"OceanOak","updated_at":"2026-01-12T12:01:08.329321875Z"}
{"id":"app-s4j","title":"Design: Dependency Index for tracking references","description":"Foundation for update propagation. Need to track reverse dependencies - given a UUID, what other UUIDs reference it?\n\n## Key Design Decisions\n\n1. **Storage**: SQL table vs in-memory index vs hybrid?\n   - SQL: persistent, queryable, but slower\n   - In-memory: fast, but needs rebuilding on restart\n   - Hybrid: SQL as source of truth, in-memory cache\n\n2. **Granularity**: Track at what level?\n   - Function → Function (coarse)\n   - Function → specific expression location (fine, enables better UI)\n\n3. **When to populate**:\n   - During AddFn/AddType/AddValue ops (walk AST for referenced UUIDs)\n   - Lazily on first query?\n\n4. **Schema sketch**:\n```sql\nCREATE TABLE references (\n  source_id UUID,      -- the definition containing the reference\n  target_id UUID,      -- the definition being referenced  \n  source_branch UUID,\n  ref_type TEXT,       -- 'fn_call', 'type_ref', 'value_ref'\n  PRIMARY KEY (source_id, target_id, ref_type)\n);\nCREATE INDEX idx_references_target ON references(target_id);\n```\n\n5. **Cross-branch**: Track references across branches or only within same branch?","status":"open","priority":1,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T14:43:24.444418965Z","created_by":"OceanOak","updated_at":"2026-01-12T14:43:24.444418965Z","dependencies":[{"issue_id":"app-s4j","depends_on_id":"app-7rl","type":"parent-child","created_at":"2026-01-12T14:47:37.330503804Z","created_by":"OceanOak"}]}
{"id":"app-uvh","title":"VSCode: Double file-change events in darkFileSystemProvider","description":"In darkFileSystemProvider.ts writeFile(), _emitter.fire() is called twice on success when updatedContent is present (lines 161-164 and 182-186). This causes editor flicker and redundant re-fetches. Fix: only fire once after updating cache.","status":"open","priority":1,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:49:26.499271676Z","created_by":"OceanOak","updated_at":"2026-01-12T11:49:26.499271676Z"}
{"id":"app-vtj","title":"VSCode: Missing Content-Security-Policy in webview","description":"homepagePanel.ts _getHtmlForWebview() has no CSP meta tag. This allows XSS if any server data is rendered unescaped. Fix: add restrictive CSP with nonce for inline scripts, escape all dynamic content.","status":"open","priority":1,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:50:45.361824337Z","created_by":"OceanOak","updated_at":"2026-01-12T11:50:45.361824337Z"}
{"id":"app-wro","title":"VSCode: Add activation events to package.json","description":"Missing activationEvents means extension activates on every VS Code startup. Add: onLanguage:darklang, onCommand:darklang.openHomepage, onView:darklangPackages, etc.","status":"open","priority":2,"issue_type":"task","owner":"oakocean9@gmail.com","created_at":"2026-01-12T12:00:17.477023171Z","created_by":"OceanOak","updated_at":"2026-01-12T12:00:17.477023171Z"}
{"id":"app-xcb","title":"VSCode: Branch state divergence risk","description":"branchStateManager.ts setCurrentBranchById sets _currentBranchId before LSP call succeeds. If LSP fails, local and server state diverge. Fix: only set local state after LSP confirms.","status":"open","priority":2,"issue_type":"bug","owner":"oakocean9@gmail.com","created_at":"2026-01-12T11:55:15.458201379Z","created_by":"OceanOak","updated_at":"2026-01-12T11:55:15.458201379Z"}
